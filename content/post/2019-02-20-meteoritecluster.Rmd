---
title: "Hacking Meteorites: Using DBSCAN for mineral analysis"
author: "Cecina Babich Morrow"
date: 2019-02-20T21:13:14-05:00
categories: ["Hackathon", "Meteorites", "Python"]
tags: ["hackathon", "meteorites", "earth science", "Python"]
draft: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, engine.path = list(python = '/anaconda3/bin/python3.6'))
```

```{r, include=FALSE}
library(reticulate)
```


<figure>
  <img class="special-img-class" style="width:100%" src="/img/obj2_cluster_pred.png" />
</figure>

Earlier this month I participated in the American Museum of Natural History's annual hackathon (see my last [post](https://babichmorrowc.github.io/post/2019-02-14-hackathon/) for details about the event overall). During the hackathon, I worked with Katy Abbott, another Helen Fellow at the museum with me, to use a machine learning algorithm called DBSCAN to tackle our challenge.

## Challenge accepted

Our team, consisting of Peter Kang, Jackson Lee, Jeremy Neiman, John Underwood, Katy Abbott, Meret GÃ¶tschel, and myself, chose to work on the [Meteorite Mineral Mapping challenge](https://github.com/amnh/HackTheSolarSystem/wiki/Meteorite-Mineral-Mapping). For this challenge, our museum stakeholders, Marina Gemma and Sam Alpert, wanted a way to identify the mineral composition of meteorites.

## Pixels to percents

The scientists scan meteorites with an electron microprobe, a device that provides the intensity of x-rays emitted from certain elements. The electron microprobe results in images with grayscale intensities corresponding to these x-ray intensities on a pixel-by-pixel basis.

<figure>
  <img class="special-img-class" style="width:100%" src="/img/meteorite_pixel_intensity.png" />
  <figcaption>Images of a meteorite produced by the electron microprobe showing pixel intensities for each of 10 elements - brighter grayscale values indicate greater amounts of that element in a pixel.</figcaption>
</figure>

Our first step was to convert these pixel intensities to the percent weight of each element in the mineral at that pixel. To do that, we referred to a set of standard images taken of minerals with a known proportion of each element. For example, the image below shows the pixel intensities of iron in 8 minerals: you can see that the pixels are brightest in Fe, or pure iron, and lower in iron oxide ($\text{Fe}_3\text{O}_4$) and troilite, or iron sulfide (FeS).

<figure>
  <img class="special-img-class" style="width:100%" src="/img/iron_standard.png" />
  <figcaption>Standard scan of the intensity of iron in each of 8 known minerals.</figcaption>
</figure>

We can relate the intensity of the iron pixels in the Fe mineral, for example, to the percent weight in that mineral (100%, since iron is the only element in Fe). There is a linear relationship between pixel intensity and percent weight, so we used linear regression to find the slope of this relationship.

```{python}
# import libraries
from sklearn.cluster import DBSCAN as dbscan
import pandas as pd
import numpy as np
from sklearn import metrics
import matplotlib.pyplot as plt
import matplotlib.colors
from sklearn.decomposition import PCA
from pathlib import Path
from skimage.io import imread, imshow
import numpy.ma as ma
from collections import Counter
```

(Note: I was able to add the above Python chunk in R by following [these instructions]())

## Further Reading

Jeremy Neiman, one of my team members, wrote an excellent [post](https://towardsdatascience.com/machine-learning-meteorites-fcd8f6859ed7) describing the challenge in further detail, so check that out for more information.



